{"version":3,"sources":["validation_patterns.js","formhandler_options.js","formshandler.js","formhandler_datalayer.js"],"names":["validationPatterns","type","pattern","omittedAtributes","urlN","createEnterKeydownHandler","inputElement","submitTriggerElement","e","key","preventDefault","blur","click","validateInput","input","name","getAttribute","value","required","error","find","p","test","$","next","toggleClass","addClass","handleBlur","event","target","validateForm","formElement","inputs","querySelectorAll","errors","forEach","sendFormDataToURL","form","formData","FormData","attributes","i","length","attributeName","replace","attributeValue","includes","append","inputElements","countryValues","marketplaceValues","inputValue","inputName","nextElementSibling","textContent","trim","checked","push","ajax","url","data","processData","contentType","success","parent","hide","show","siblings","handleSubmitClick","this","closest","trackFormSubmit","formSelector","successParams","errorParams","document","ajaxComplete","xhr","eventData","eventLabel","window","location","href","eventType","status","Object","assign","eventAction","dataLayer","console","log","submitButton","querySelector","addEventListener","on","triggerName","body","eventCategory"],"mappings":"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","file":"main.min.js","sourcesContent":["\nconst validationPatterns = [\n  {\n    type: \"email\",\n    pattern: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/,\n  },\n  {\n    type: \"phone\",\n    pattern: /^\\d\\d\\d\\d\\d\\d\\d\\d\\d$/,\n  },\n  {\n    type: \"text\",\n    pattern: /^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/,\n  },\n  {\n    type: \"nip\",\n    pattern: /^\\d\\d\\d\\d\\d\\d\\d\\d\\d\\d$/,\n  },\n  {\n    type: \"url\",\n    pattern: /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/,\n  },\n];\n","const omittedAtributes = [\"method\", \"name\", \"id\", \"class\", \"aria-label\", \"fs-formsubmit-element\", \"wf-page-id\", \"wf-element-id\"];\n\nconst urlN = \"https://www.shoper.pl/ajax.php\";\n","function createEnterKeydownHandler(inputElement, submitTriggerElement) {\n  return function (e) {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      inputElement.blur();\n      submitTriggerElement.click();\n    }\n  };\n}\n\n\nfunction validateInput(input) {\n  const name = input.getAttribute(\"data-form\");\n  const value = input.value;\n  const required = input.required;\n  const type = input.getAttribute(\"data-type\");\n\n  error = required ? (value === \"\" ? `${name} - jest wymagane` : null) : null;\n\n  if (!error && value !== \"\" && required) {\n    const pattern = validationPatterns.find((p) => p.type === type)?.pattern;\n    if (pattern && !pattern.test(value)) {\n      error = `${name} nie jest wypełnione prawidłowo`;\n    }\n  }\n\n  if (required && value === \"\") {\n    $(input).next().next().toggleClass(\"show\", true);\n    $(input).next().toggleClass(\"show\", false);\n    $(input).addClass(\"error\");\n  } else {\n    $(input).next().next().toggleClass(\"show\", false);\n    $(input)\n      .next()\n      .toggleClass(\"show\", error !== null);\n    $(input).toggleClass(\"error\", error !== null);\n  }\n\n  return error;\n}\n\nfunction handleBlur(event) {\n  validateInput(event.target);\n}\n\n\ndocument.querySelectorAll(\"input\").forEach((input) => {\n  const submitButton = input.closest(\"form\").querySelector(\"[data-form='submit']\");\n\n  input.addEventListener(\"blur\", handleBlur);\n  input.addEventListener(\"keydown\", createEnterKeydownHandler(input, submitButton));\n});\n\nfunction validateForm(formElement) {\n  const inputs = formElement.querySelectorAll(\"input\");\n\n  let errors = 0;\n\n  inputs.forEach((input) => {\n    if (validateInput(input)) {\n      errors++;\n    }\n  });\n\n  return errors;\n}\n\n\nfunction sendFormDataToURL(urlN, formElement, form) {\n  const formData = new FormData();\n\n  const attributes = formElement.attributes;\n  for (let i = 0; i < attributes.length; i++) {\n    const attributeName = attributes[i].name.replace(\"data-\", \"\");\n    const attributeValue = attributes[i].value;\n    if (attributeValue !== \"\" && !omittedAtributes.includes(attributeName)) {\n      formData.append(attributeName, attributeValue);\n    }\n  }\n\n  const inputElements = formElement.querySelectorAll(\"input, textarea\");\n  let countryValues = [];\n  let marketplaceValues = [];\n  inputElements.forEach((inputElement) => {\n    let inputValue = inputElement.value;\n    const inputName = inputElement.getAttribute(\"data-form\");\n    if (inputElement.type === \"checkbox\") {\n      inputValue = inputElement.nextElementSibling.textContent.replace(/[^\\u0000-\\u007F\\u0100-\\u017F]+/g, \"\").trim();\n      if (inputName === \"country\" && inputElement.checked) {\n        countryValues.push(inputValue);\n      } else if (inputName === \"marketplace\" && inputElement.checked) {\n        marketplaceValues.push(inputValue);\n      }\n    } else if (inputValue !== \"\") {\n      formData.append(inputName, inputValue);\n    }\n  });\n\n  if (countryValues.length > 0) {\n    formData.append(\"country\", countryValues);\n  }\n\n  if (marketplaceValues.length > 0) {\n    formData.append(\"marketplace\", marketplaceValues);\n  }\n\n  $.ajax({\n    type: \"POST\",\n    url: urlN,\n    data: formData,\n    processData: false,\n    contentType: false,\n    success: function () {\n      $(form).parent().hide();\n      $(form).parent().next().show();\n    },\n    error: function () {\n      $(form).siblings(\".error-message\").show();\n    },\n  });\n}\n\nfunction handleSubmitClick(e) {\n  e.preventDefault();\n  const form = this;\n  const formElement = this.closest(\"form\");\n  if (validateForm(formElement) === 0) {\n    sendFormDataToURL(urlN, formElement, form);\n  }\n}\n\n$(\"[data-form='submit']\").click(handleSubmitClick);\n\n$(\"[data-app^='open_']\").on(\"click\", function () {\n  const triggerName = $(this)\n    .data(\"app\")\n    .replace(/^open_|_modal_button$/g, \"\");\n  $(`[data-app='${triggerName}']`).addClass(\"modal--open\");\n  $(document.body).toggleClass(\"overflow-hidden\", true);\n});\n","\nfunction trackFormSubmit(formSelector, successParams, errorParams) {\n  $(document).ajaxComplete(function (xhr) {\n    const form = $(formSelector)[0];\n    const eventData = {\n      eventLabel: window.location.href,\n      eventType: form.getAttribute(\"data-app\"),\n    };\n    if (xhr.status === 200) {\n      Object.assign(eventData, successParams, { eventAction: \"submitSuccess\" });\n    } else {\n      Object.assign(eventData, errorParams, { eventAction: \"submitError\" });\n    }\n    window.dataLayer.push(eventData);\n    console.log(window.dataLayer);\n  });\n}\n\ntrackFormSubmit(\"[data-app='consult']\", { event: \"event1-onsuccess\", eventCategory: \"category1\" }, { event: \"event2-onerror\", eventCategory: \"category2\" });\n"]}