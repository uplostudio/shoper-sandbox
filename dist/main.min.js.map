{"version":3,"sources":["validation_patterns.js","formhandler_options.js","formshandler.js","formhandler_datalayer.js"],"names":["validationPatterns","type","pattern","omittedAtributes","url","error","createEnterKeydownHandler","inputElement","submitTriggerElement","e","key","preventDefault","blur","click","validateInput","input","name","getAttribute","value","required","find","p","test","$","next","toggleClass","addClass","console","log","handleBlur","event","target","validateForm","formElement","inputs","querySelectorAll","errors","forEach","sendFormDataToURL","form","formData","FormData","attributes","i","length","attributeName","replace","attributeValue","includes","append","inputValue","inputName","ajax","data","processData","contentType","success","parent","hide","show","siblings","handleSubmitClick","this","closest","trackFormSubmit","formSelector","successParams","errorParams","document","ajaxComplete","xhr","eventData","eventLabel","window","location","href","eventType","status","Object","assign","eventAction","dataLayer","push","submitButton","querySelector","addEventListener","on","triggerName","eventCategory"],"mappings":"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","file":"main.min.js","sourcesContent":["\nconst validationPatterns = [\n  {\n    type: \"email\",\n    pattern: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/,\n  },\n  {\n    type: \"phone\",\n    pattern: /^\\d\\d\\d\\d\\d\\d\\d\\d\\d$/,\n  },\n  {\n    type: \"text\",\n    pattern: /^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/,\n  },\n  {\n    type: \"nip\",\n    pattern: /^\\d\\d\\d\\d\\d\\d\\d\\d\\d\\d$/,\n  },\n  {\n    type: \"url\",\n    pattern: /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/,\n  },\n];\n","const omittedAtributes = [\"method\", \"name\", \"id\", \"class\", \"aria-label\", \"fs-formsubmit-element\"];\n\nconst url = \"https://www.shoper.pl/ajax.php\";\n","let error;\n\nfunction createEnterKeydownHandler(inputElement, submitTriggerElement) {\n  return function (e) {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      inputElement.blur();\n      submitTriggerElement.click();\n    }\n  };\n}\n\n\nfunction validateInput(input) {\n  const name = input.getAttribute(\"data-form\");\n  const value = input.value;\n  const required = input.required;\n  const type = input.getAttribute(\"data-type\");\n\n  error = required ? (value === \"\" ? `${name} - jest wymagane` : null) : null;\n\n  if (!error && value !== \"\" && required) {\n    const pattern = validationPatterns.find((p) => p.type === type)?.pattern;\n    if (pattern && !pattern.test(value)) {\n      error = `${name} nie jest wypełnione prawidłowo`;\n    }\n  }\n\n  if (required && value === \"\") {\n    $(input).next().next().toggleClass(\"show\", true);\n    $(input).next().toggleClass(\"show\", false);\n    $(input).addClass(\"error\");\n  } else {\n    $(input).next().next().toggleClass(\"show\", false);\n    $(input)\n      .next()\n      .toggleClass(\"show\", error !== null);\n    $(input).toggleClass(\"error\", error !== null);\n  }\n\n  console.log(error);\n\n  return error;\n}\n\nfunction handleBlur(event) {\n  validateInput(event.target);\n}\n\n\ndocument.querySelectorAll(\"input\").forEach((input) => {\n  const submitButton = input.closest(\"form\").querySelector(\"[data-form='submit']\");\n\n  input.addEventListener(\"blur\", handleBlur);\n  input.addEventListener(\"keydown\", createEnterKeydownHandler(input, submitButton));\n});\n\nfunction validateForm(formElement) {\n  const inputs = formElement.querySelectorAll(\"input\");\n\n  let errors = 0;\n\n  inputs.forEach((input) => {\n    if (validateInput(input)) {\n      errors++;\n    }\n  });\n\n  return errors;\n}\n\n\nfunction sendFormDataToURL(url, formElement, form) {\n  const formData = new FormData();\n\n  const attributes = formElement.attributes;\n  for (let i = 0; i < attributes.length; i++) {\n    const attributeName = attributes[i].name.replace(\"data-\", \"\");\n    const attributeValue = attributes[i].value;\n    if (attributeValue !== \"\" && !omittedAtributes.includes(attributeName)) {\n      formData.append(attributeName, attributeValue);\n    }\n  }\n  const inputElements = formElement.querySelectorAll(\"input, textarea\");\n  inputElements.forEach((inputElement) => {\n    const inputValue = inputElement.value;\n    const inputName = inputElement.getAttribute(\"data-form\");\n    if (inputValue !== \"\") {\n      formData.append(inputName, inputValue);\n    }\n  });\n\n  $.ajax({\n    type: \"POST\",\n    url: url,\n    data: formData,\n    processData: false,\n    contentType: false,\n    success: function () {\n      $(form).parent().hide();\n      $(form).parent().next().show();\n    },\n    error: function () {\n      $(form).siblings(\".error-message\").show();\n    },\n  });\n}\n\nfunction handleSubmitClick(e) {\n  e.preventDefault();\n  const form = this;\n  const formElement = this.closest(\"form\");\n\n  if (validateForm(formElement) === 0) {\n    sendFormDataToURL(url, formElement, form);\n  }\n}\n\n$(\"[data-form='submit']\").click(handleSubmitClick);\n\n$(\"[data-app^='open_']\").on(\"click\", function () {\n  const triggerName = $(this)\n    .data(\"app\")\n    .replace(/^open_|_modal_button$/g, \"\");\n  $(`[data-app='${triggerName}']`).addClass(\"modal--open\");\n  console.log(triggerName);\n});\n","function trackFormSubmit(formSelector, successParams, errorParams) {\n  $(document).ajaxComplete(function (xhr) {\n    const form = $(formSelector)[0];\n    const eventData = {\n      eventLabel: window.location.href,\n      eventType: form.getAttribute(\"data-app\"),\n    };\n    if (xhr.status === 200) {\n      Object.assign(eventData, successParams, { eventAction: \"submitSuccess\" });\n    } else {\n      Object.assign(eventData, errorParams, { eventAction: \"submitError\" });\n    }\n    window.dataLayer.push(eventData);\n    console.log(window.dataLayer);\n  });\n}\n\ntrackFormSubmit(\"[data-app='consult']\", { event: \"event1-onsuccess\", eventCategory: \"category1\" }, { event: \"event2-onerror\", eventCategory: \"category2\" });\n"]}