{"version":3,"sources":["validation_patterns.js","formhandler_options.js","formshandler.js","formhandler_datalayer.js"],"names":["validationPatterns","type","pattern","omittedAtributes","urlN","createEnterKeydownHandler","inputElement","submitTriggerElement","e","key","preventDefault","blur","click","validateInput","input","name","getAttribute","value","required","error","find","p","test","$","next","toggleClass","addClass","handleBlur","event","target","validateForm","formElement","inputs","querySelectorAll","errors","forEach","sendFormDataToURL","form","loader","formData","FormData","attributes","i","length","attributeName","replace","attributeValue","includes","append","inputElements","countryValues","marketplaceValues","inputValue","inputName","nextElementSibling","textContent","trim","checked","push","ajax","url","data","processData","contentType","success","show","has","status","siblings","hide","window","location","href","redirect","successResponse","parent","errorResponse","handleSubmitClick","this","closest","pushDataToDataLayer","eventCategory","eventAction","text","eventLabel","pathname","leadOfferText","originalTrigger","attr","lead_offer","dataLayer","console","log","document","submitButton","querySelector","addEventListener","on","triggerName","body"],"mappings":"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","file":"main.min.js","sourcesContent":["\nconst validationPatterns = [\n  {\n    type: \"email\",\n    pattern: /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/,\n  },\n  {\n    type: \"phone\",\n    pattern: /^\\d\\d\\d\\d\\d\\d\\d\\d\\d$/,\n  },\n  {\n    type: \"text\",\n    pattern: /^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/,\n  },\n  {\n    type: \"nip\",\n    pattern: /^\\d\\d\\d\\d\\d\\d\\d\\d\\d\\d$/,\n  },\n  {\n    type: \"url\",\n    pattern: /^(http:\\/\\/www\\.|https:\\/\\/www\\.|http:\\/\\/|https:\\/\\/)?[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$/,\n  },\n];\n","const omittedAtributes = [\"method\", \"name\", \"id\", \"class\", \"aria-label\", \"fs-formsubmit-element\", \"wf-page-id\", \"wf-element-id\"];\n\nconst urlN = \"https://www.shoper.pl/ajax.php\";\n","function createEnterKeydownHandler(inputElement, submitTriggerElement) {\n  return function (e) {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      inputElement.blur();\n      submitTriggerElement.click();\n    }\n  };\n}\n\n\nfunction validateInput(input) {\n  const name = input.getAttribute(\"data-form\");\n  const value = input.value;\n  const required = input.required;\n  const type = input.getAttribute(\"data-type\");\n\n  error = required ? (value === \"\" ? `${name} - jest wymagane` : null) : null;\n\n  if (!error && value !== \"\" && required) {\n    const pattern = validationPatterns.find((p) => p.type === type)?.pattern;\n    if (pattern && !pattern.test(value)) {\n      error = `${name} nie jest wypełnione prawidłowo`;\n    }\n  }\n\n  if (required && value === \"\") {\n    $(input).next().next().toggleClass(\"show\", true);\n    $(input).next().toggleClass(\"show\", false);\n    $(input).addClass(\"error\");\n  } else {\n    $(input).next().next().toggleClass(\"show\", false);\n    $(input)\n      .next()\n      .toggleClass(\"show\", error !== null);\n    $(input).toggleClass(\"error\", error !== null);\n  }\n\n  return error;\n}\n\nfunction handleBlur(event) {\n  validateInput(event.target);\n}\n\n\ndocument.querySelectorAll(\"input\").forEach((input) => {\n  const submitButton = input.closest(\"form\").querySelector(\"[data-form='submit']\");\n\n  input.addEventListener(\"blur\", handleBlur);\n  input.addEventListener(\"keydown\", createEnterKeydownHandler(input, submitButton));\n});\n\nfunction validateForm(formElement) {\n  const inputs = formElement.querySelectorAll(\"input\");\n\n  let errors = 0;\n\n  inputs.forEach((input) => {\n    if (validateInput(input)) {\n      errors++;\n    }\n  });\n\n  return errors;\n}\n\n\nfunction sendFormDataToURL(urlN, formElement, form, loader) {\n  const formData = new FormData();\n\n  const attributes = formElement.attributes;\n  for (let i = 0; i < attributes.length; i++) {\n    const attributeName = attributes[i].name.replace(\"data-\", \"\");\n    const attributeValue = attributes[i].value;\n    if (attributeValue !== \"\" && !omittedAtributes.includes(attributeName)) {\n      formData.append(attributeName, attributeValue);\n    }\n  }\n\n  const inputElements = formElement.querySelectorAll(\"input, textarea\");\n  let countryValues = [];\n  let marketplaceValues = [];\n  inputElements.forEach((inputElement) => {\n    let inputValue = inputElement.value;\n    const inputName = inputElement.getAttribute(\"data-form\");\n    if (inputElement.type === \"checkbox\") {\n      inputValue = inputElement.nextElementSibling.textContent.replace(/[^\\u0000-\\u007F\\u0100-\\u017F]+/g, \"\").trim();\n      if (inputName === \"country\" && inputElement.checked) {\n        countryValues.push(inputValue);\n      } else if (inputName === \"marketplace\" && inputElement.checked) {\n        marketplaceValues.push(inputValue);\n      }\n    } else if (inputValue !== \"\") {\n      formData.append(inputName, inputValue);\n    }\n  });\n\n  if (countryValues.length > 0) {\n    formData.append(\"country\", countryValues);\n  }\n\n  if (marketplaceValues.length > 0) {\n    formData.append(\"marketplace\", marketplaceValues);\n  }\n\n  $.ajax({\n    type: \"POST\",\n    url: urlN,\n    data: formData,\n    processData: false,\n    contentType: false,\n    success: function (data) {\n      loader.show();\n      if (formData.has(\"host\")) {\n        if (data.status === 1) {\n          $(formElement).siblings(\".error-message\").hide();\n          loader.hide();\n          window.location.href = data.redirect;\n          return;\n        } else {\n          loader.hide();\n          $(formElement).siblings(\".error-message\").show();\n          return;\n        }\n      }\n      successResponse(formElement);\n      $(form).parent().hide();\n      $(form).parent().next().show();\n    },\n    error: function () {\n      errorResponse(formElement);\n      $(formElement).siblings(\".error-message\").show();\n    },\n  });\n}\n\nfunction handleSubmitClick(e) {\n  e.preventDefault();\n  const form = this;\n  const formElement = this.closest(\"form\");\n  const loader = $(this).find(\".loading-in-button\");\n  if (validateForm(formElement) === 0) {\n    sendFormDataToURL(urlN, formElement, form, loader);\n  }\n}\n\n$(\"[data-form='submit']\").click(handleSubmitClick);\n\n$(\"[data-app^='open_']\").on(\"click\", function () {\n  originalTrigger = $(this);\n  const triggerName = originalTrigger.data(\"app\").replace(/^open_|_modal_button$/g, \"\");\n  $(`[data-app='${triggerName}']`).addClass(\"modal--open\");\n  $(document.body).toggleClass(\"overflow-hidden\", true);\n});\n\n\n$(\"[fs-formsubmit-element='reset']\").on(\"click\", function () {\n  $(\".loading-in-button\").hide();\n});\n","function pushDataToDataLayer(formElement, eventCategory) {\n  if (formElement.getAttribute(\"data-layer\") !== \"true\") {\n    return;\n  }\n\n  const data = {\n    event: \"myTrackEvent\",\n    eventCategory: eventCategory,\n    eventAction: $(formElement).find(\"#label\").text(),\n    eventLabel: window.location.pathname,\n  };\n\n  const leadOfferText = $(originalTrigger).attr(\"data-lead_offer\");\n\n  if (leadOfferText) {\n    data.lead_offer = leadOfferText;\n  }\n\n  window.dataLayer = window.dataLayer || [];\n  window.dataLayer.push(data);\n  console.log(window.dataLayer);\n}\n\nfunction successResponse(formElement) {\n  pushDataToDataLayer(formElement, \"Button modal form sent\");\n}\n\nfunction errorResponse(formElement) {\n  pushDataToDataLayer(formElement, \"Button modal form error\");\n}\n"]}